# Αρχιτεκτονική Υπολογιστών

**3o Εργαστήριο**  
**Ομάδα 10: Χελάκης Κωνσταντίνος Μάριος** 

# Ερωτήματα

# Βήμα 1ο:  

## 1ο Ερώτημα   
### Εξηγήστε τι είναι το dynamic power και leakage 

**Μοντελοποίηση ισχύος**: 

![Image 1: Power equation](/Lab3/images%20%26%20charts/power%20equation.png)

Όπως φαίνεται και στην παραπάνω σχέση, οι απώλειες ισχύος σε ένα κύκλωμα CMOS εξαρτώνται από τρεις παράγοντες: **τις δυναμικές** *(dynamic)* **, τα βραχυκυκλώματα** *(short-circuit)* και τις **διαρροές** *(leakage).* Και οι τρεις παράγοντες συμβάλουν σημαντικά στην συνολική κατανάλωση ισχύος. 

Ο πρώτος όρος **Dynamic Power** καταναλώνεται στην φόρτιση και εκφόρτιση των χωρητικών φορτίων του κυκλώματος και ειδικότερα στις αλλαγές κατάστασης του. Στην παραπάνω εξίσωση *C* είναι η συνολική χωρητικότητα του φορτίου, *Vdd* είναι η τάση τροφοδοσίας, *ΔV* η διαφορά της τάσης κατά την εναλαγή και *fclk* η συχνότητα του ρολογιού.

Ο δεύτερος όρος **Short-Circuit Power** είναι η ισχύς που κατανανλώνεται κατά τις εναλλαγές κατάστασης δηλαδή όταν και το pull-up και το pull-down κύκλωμα είναι για πολύ μικρό χρονικό διάστημα ενεργά. Η ισχύς βραχυκύκλωσης είναι περίπου το 10% της συνολικής δυναμικής ισχύος. 

Κατά την εναλλαγή κατάστασης σε ένα κύκλωμα καταναλώνεται τόσο δυναμική όσο και ισχύς βραχυκύκλωσης.

Ο τρίτος όρος **Leakage** αναφέρεται στις στατικές απώλειες ισχύος που συμβαίνουν στα τρανζίστορ. Υπάρχουν δύο μηχανισμοί διαρροής και το μέγεθος και των δύο είναι ανάλογο με το πλάτος κάθε τρανζίστορ και την λογική κατάσταση στην οποία βρίσκεται. 

Ο πρώτος τύπος διαρροής ρεύματος είναι η **διαρροή κατοφλίου**. Αυτή συμβαίνει όταν ενώ κάποια έξοδος βρίσκεται στο λογικό 0, υπάρχει μία πολύ μικρή διαρροή ρεύματος η οποία πρέπει να ληφθεί υπόψιν. 

Ο δεύτερος τύπος διαρροής ονομάζεται **διαρροή πύλης** και αναφέρεται στο ρεύμα που διαρρέει από την πύλη (υπόστρωμα) του τρανζίστορ.

Οι συνολικές απώλειες που έχουμε λόγω διαρροής είναι **ανάλογες του συνόλικού αριθμού των τρανζίστορ** του συστήματος μας **που δεν αλλάζουν κατάσταση**.

### Ποιο θα μεταβληθεί αν τρέξουμε διαφορετικά προγράμματα στον επεξεργαστή;

Η εκτέλεση ενός προγράμματος υψηλών απαιτήσεων που θα χρειαστεί περισσότερα τρανζίστορ για να τρέξει, **θα αυξήσει τη συνολική δυναμική ισχύ**. Αυτό συμβαίνει διοτι περισσότερα τρανζίστορ θα μεταβούν από την μία κατάσταση στην άλλη, πράγμα που αυξάνει τον συγκεκριμένο τύπο ισχύος.

Από την άλλη, οι διαρροές ρεύματος *(leakage)* εξαρτώνται από τον αριθμό των τρανζίστορ που δεν χρησιμοποιούνται. Συνεπώς ένα μη απαιτητικό πρόγραμμα που δεν χρησιμοποιεί πολλά τρανζίστορ θα έχει περισσοτερες τέτοιες διαρροές αφού το ρεύμα θα παιρνάει από τις κλειστές πύλες.

### Έχει σημασία πόσο μεγάλο σε χρονική διάρκεια είναι ένα πρόγραμμα;

## 2ο ερώτημα

## Ενεργειακή αποδοτικότητα επεξεργαστή

Έχοντας δύο επεξεργαστές διαφορετικής ισχύος *(5W και 40W)* και βασιζόμενοι σε αυτά που αναλύσαμε παραπάνω μπορούμε να καταλήξουμε στα εξής συμπεράσματα μεταβάλλοντας την **ισχύ διαρροής** και την **δυναμική ισχύ**:

Η ΄**δυναμική ισχύς** μπορεί να μεταβληθεί *μειώνοντας* την συχνότητα του επεξεργαστή έτσι ώστε να μειώνεται ο αριθμός των εναλλαγών καταστάσεων στο σύστημα μας. Επίσης μπορούμε να αλλάξουμε την τάση τροφοδοσίας έτσι ώστε να έχω μικρότερη κατανάλωση. Προφανώς και στις δύο περιπτώσεις θα **πρέπει να λάβουμε υπόψιν** ότι με αυτό τον τρόπο **μειώνουμε την ταχύτητα και την συνολική απόδοση** του συστήματος μας και έτσι πρέπει να σκεφτούμε καλύτερα τις αλλαγές μας.

Η **ισχύς διαρροής** μπορεί να μεταβληθεί σταματόντας εντελώς την παροχή ρεύματος σε τρανζίστορ *(ή ομάδες τρανζίστορ)* που δεν χρησιμοποιούνται μια δεδομένη χρονική στιγμή.

Το **McPat** από μόνο του δεν μπορεί να μας δώσει τις απαραίτητες πληροφορίες για την κατανάλωση ισχύος καθώς ενώ μας δίνει πληροφορίες για τον τύπο των διάφορων απωλειών ενός επεξεργαστή, δεν μας έχει δώσει μέχρι στιγμής πληροφορίες για τα προγράμματα του υπολογιστή και με πιο σημαντική από αυτές τον **χρόνο εκτέλεσης** του κάθε προγράμματος. Οι πληροφορίες αυτές όπως είδαμε και στα προηγούμενα εργαστήρια παρέχονται από τον **Gem5**.  


## 3ο ερώτημα

## Xeon vs ARM Cortex A9

Στο παρακάτω ερώτημα θα προσπαθήσουμε να εξηγήσουμε γιατί ο Xeon δεν μπορεί να είναι πιο energy efficient από τον Α9.

|Type: | Xeon |	ARM Cortex-A9 |
|---  |---  |---  |
|Technology |	65nm |	40nm |
|Clock Frequency	| 3.4 GHz |	2 GHz |
|Area	| 410.507 mm^2	 |5.39698 mm^2 |
|Peak Power	|134.938 W |	1.74189 W |
|Total Leakage	| 36.832 W	| 0.10868 W |
|Peak Dynamic	| 98.106 W	| 1.6332 W |
|Subthreshold Leakage |	35.163 W |	0.0523094 W |
|Subthreshold Leakage with power gating	 | 16.3977 W	 | - |
|Gate Leakage	| 1.66871 W |	0.0563774 W |
|Runtime Dynamic |	72.9199 W	 | 2.96053 W |

Η συνολική ενέργεια που χρησιμοποιήθηκε μπορεί να βρεθεί από τον τύπο: *Ε = P * t*, οπου P οι απώλειες ισχύος (δυναμική ισχύς και ισχύ διαρροής). 

Έτσι έχω:  

Για τον *Xeon:*

**E = (P[dynamic] + P[leakage]) * t = (72.9199 + 36.832) * t = 109,7519t W**

Για τον *Α9:* 

**Ε = (P[dynamic] + P[leakage]) * 40 t = (2.96053 + 0.10868) * 40 t = 122,76868 W**

Βλέπω ότι E(Xeon) < E(A9), ωστόσο θα πρέπει να λάβω υπόψιν ότι ο Xeon μετά την εκτέλεση του προγράμματος δεν θα τερματίσει την λειτουργία του αλλά θα περιμένει να τελείωσει η λειτουργία του Α9. Γι αυτό τον λόγο θα πρέπει να ληφθεί υπ' όψιν και το ρεύμα διαρροής το οποίο θα παιρνάει από τα κλειστά τρανζίστορ για αυτό το χρονικό διάστημα το οποίο είναι 36.163 * 39 t = 1410,35 J. Άρα ο Xeon δεν μπορεί να είναι πιο energy efficient.



# Βήμα 2ο:  gem5 + McPAT: αναζητώντας τη βελτιστοποίηση του γινομένου EDAP

## 1o Ερώτημα: Από που θα αντηλήσουμε πληροφορίες σχετικά με το delay και πως θα υπολογίσουμε το energy;

**Area:** Μπορεί να βρεθεί από την έξοδο του McPat

**Delay:** Μπορεί να βρεθεί από το αρχείο stats του Gem5. Είναι ο συνολικός χρόνος προσομοίωσης *(total simulation seconds)*

**Energy:** Όπως αναφέρθηκε και παραπάνω μπορεί να δωθεί από την εξίσωση:  *Ε = P * t*, οπου P οι απώλειες ισχύος (δυναμική ισχύς και ισχύ διαρροής). 

## 2ο ερώτημα: Δείξτε την επίδραση κάθε παραμέτρου που αλλάξατε στη προηγούμενη άσκηση 





